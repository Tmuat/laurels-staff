{% extends "vertical_base.html" %}
{% load static i18n %}
{% load humanize %}

{% block head_title %}{% trans "Property Detail" %}{% endblock head_title %}

{% block content %}
    <!-- Start Content-->
    <div class="container-fluid">

        <!-- start page title -->
        <div class="row">
            <div class="col-12">
                <div class="page-title-box">
                    <div class="page-title-right">
                        <ol class="breadcrumb m-0 p-0">
                            <li class="breadcrumb-item"><a href="{% url 'home:home' %}"><i class="uil-home-alt"></i> Home</a></li>
                            <li class="breadcrumb-item"><a href="{% url 'properties:property_list' %}"><i class="mdi mdi-warehouse"></i> Properties</a></li>
                            <li class="breadcrumb-item active" aria-current="page">Detail</li>
                        </ol>
                    </div>
                    <h4 class="page-title">Property Detail</h4>
                </div>
            </div>
        </div>     
        <!-- end page title --> 

        <!-- header row -->
        <div class="row">
            <div class="col-sm-12">
                <!-- Property -->
                <div class="card bg-success">
                    <div class="card-body">

                        <div class="row">
                            <div class="col-sm-8">
                                <div class="media">
                                    <div class="media-body">

                                        <h4 class="mt-1 mb-1 text-white">{{ propertyprocess }}</h4>
                                        <p class="font-13 text-white-50">
                                            {{ propertyprocess.get_sector_display }} - {{ propertyprocess.employee }}
                                            {% if propertyprocess.legacy_property %} - {{ propertyprocess.get_legacy_property_display }}{% endif %}</p>

                                        <ul class="mb-0 list-inline text-light">
                                            <li class="list-inline-item mr-3">
                                                <h5 class="mb-1">{{ propertyprocess.get_macro_status_display }}</h5>
                                                <p class="mb-0 font-13 text-white-50">Status</p>
                                            </li>
                                            <li class="list-inline-item">
                                                <h5 class="mb-1">-</h5>
                                                <p class="mb-0 font-13 text-white-50">Another Field</p>
                                            </li>
                                        </ul>
                                    </div>
                                    <!-- end media-body-->
                                </div>
                            </div>
                            <!-- end col-->
                        </div>
                        <!-- end row -->
                    </div>
                    <!-- end card-body -->
                </div>
                <!--end property / card -->
            </div>
            <!-- end col-->
        </div>
        <!-- end row -->


        <div class="row">
            <div class="col-lg-4">
                <!-- Property-Information -->
                <div class="card">
                    <div class="card-body">
                        {% include 'properties/includes/detail/property_info.html' %}
                    </div>
                </div>
                <!-- End Property-Information -->

            </div>
            <!-- end col -->

            <div class="col-lg-8">
                <div class="card">
                    <div class="card-body">
                        <ul class="nav nav-pills bg-nav-pills nav-justified mb-3">
                            <li class="nav-item">
                                <a href="#history" data-toggle="tab" aria-expanded="true" class="nav-link rounded-0 active">
                                    History
                                </a>
                            </li>
                            {% if status_integer > 1 %}
                            <li class="nav-item">
                                <a href="#valuation" data-toggle="tab" aria-expanded="false" class="nav-link rounded-0">
                                    {% if propertyprocess.macro_status == "val" %}
                                        <span class="d-none d-md-block">Valuation</span>
                                        <span class="d-md-none">Val</span>
                                    {% else %}
                                        <span class="d-none d-md-block">Valuation & Instruction</span>
                                        <span class="d-md-none">Val & Inst</span>
                                    {% endif %}
                                </a>
                            </li>
                            {% endif %}
                            {% if status_integer > 2 %}
                            <li class="nav-item">
                                <a href="#offers" data-toggle="tab" aria-expanded="false" class="nav-link rounded-0">
                                    Offers
                                </a>
                            </li>
                            {% endif %}
                        </ul>
                        <div class="tab-content">
                            <!-- history section -->
                            <!-- tab pane -->
                            <div class="tab-pane show active" id="history">

                                <h5 class="text-uppercase"><i class="mdi mdi-history mr-1"></i>
                                    All Property History</h5>

                                <div class="table-responsive">
                                    <table class="table table-borderless table-nowrap mb-0">
                                        <thead class="thead-light">
                                            <tr>
                                                <th>Date</th>
                                                <th>Event</th>
                                                <th class="text-center">Type</th>
                                                <th class="text-center">Notes</th>
                                            </tr>
                                        </thead>
                                        <tbody id="tbody-history">
                                            {% include 'properties/includes/detail_tabs/history_table.html' %}
                                        </tbody>
                                    </table>
                                </div>
                                <div class="mt-1" id="history-pagination">
                                    {% include 'properties/includes/detail_tabs/property_history_pagination.html' %}
                                </div>
                            </div>
                            <!-- end tab-pane -->
                            <!-- end history section -->

                            <!-- valuation section -->
                            <!-- tab pane -->
                            <div class="tab-pane" id="valuation">
                                {% if propertyprocess.macro_status == "val" %}
                                    {% include 'properties/includes/detail_tabs/valuation.html' %}
                                {% else %}
                                    {% include 'properties/includes/detail_tabs/valuation.html' %}
                                    <hr>
                                    {% include 'properties/includes/detail_tabs/instruction.html' %}
                                {% endif %}
                            </div>
                            <!-- end tab pane -->
                            <!-- end valuation section -->

                            {% if status_integer > 2 %}
                            <!-- offer section -->
                            <!-- tab pane -->
                            <div class="tab-pane" id="offers">
                                <h5 class="text-uppercase"><i class="mdi mdi-currency-gbp mr-1"></i>
                                    Property Offer History {% if propertyprocess.legacy_property %} - {{ propertyprocess.get_legacy_property_display }}{% endif %}</h5>

                                <div class="table-responsive">
                                    <table class="table table-borderless table-nowrap mb-0">
                                        <thead class="thead-light">
                                            <tr>
                                                <th>Name</th>
                                                <th class="text-center">Offer Form</th>
                                                <th class="text-center">Funding</th>
                                                <th class="text-center">Latest Offer</th>
                                                <th class="text-center">Offer Status</th>
                                                <th class="text-center">Past Offers</th>
                                            </tr>
                                        </thead>
                                        <tbody id="tbody-offers">
                                            {% include 'properties/includes/detail_tabs/offer_table.html' %}
                                        </tbody>
                                    </table>
                                </div>
                                <div class="mt-1" id="offers-pagination">
                                    {% include 'properties/includes/detail_tabs/offers_pagination.html' %}
                                </div>
                            </div>
                            <!-- end tab pane -->
                            <!-- end offer section -->
                            {% endif %}

                        </div>
                        <!-- end tab-content -->
                    </div>
                    <!-- end card body -->
                </div>
                <!-- end card -->
            </div>
            <!-- end col -->

        </div>
        <!-- end row -->
        
    </div>
    <!-- container --> 
{% endblock %}

{% block extra_javascript %}
{{ block.super }}
    <script src="{% static 'properties/js/property_detail.js' %}"></script>
{% endblock %}